<!doctype html><html><head><title>NodeJS is broken</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><link rel=icon type=image/png href=/images/olivier_hu0e6c1c8c6dc6b67478684e7b00b46b4a_53705_42x0_resize_q75_box.jpeg><meta property="og:title" content="NodeJS is broken"><meta property="og:description" content="NodeJS is broken"><meta property="og:type" content="article"><meta property="og:url" content="https://olivierlespagnon.com/posts/tech/nodejs-is-broken/nodejs_is_broken/"><meta property="article:published_time" content="2023-02-13T08:06:25+06:00"><meta property="article:modified_time" content="2023-02-13T08:06:25+06:00"><meta name=description content="NodeJS is broken"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/>Olivier Lespagnon</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/posts/r%C3%A9alisations-techniques/>Réalisations techniques</a><ul><li><a href=/posts/r%C3%A9alisations-techniques/create-and-host-a-static-website-using-github-actions/github_website/ title="Create a static website">Create a static website</a></li><li><a href=/posts/r%C3%A9alisations-techniques/deploy-dependency-track/deploying-dependency-track/ title="Deploy Dependency Track">Deploy Dependency Track</a></li><li><a href=/posts/r%C3%A9alisations-techniques/hashicorp-vault/hashicorp_vault/ title="Hashicorp Vault">Hashicorp Vault</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/soft-skills/>Soft skills</a><ul><li><a href=/posts/soft-skills/learn-a-new-job/learn_for_a_new_position/ title="How to train when taking on a new position">How to train when taking on a new position</a></li><li><a href=/posts/soft-skills/how-to-write-a-good-post/writing_good_post/ title="How to write a good blog post">How to write a good blog post</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/tech/>Tech</a><ul class=active><li><a href=/posts/tech/aws-ecs-vs-eks/choose_the_right_container/ title="AWS ECS vs EKS">AWS ECS vs EKS</a></li><li><a href=/posts/tech/choosing-the-right-linux-distro/choosing_the_distro/ title="Choosing the right Linux distro">Choosing the right Linux distro</a></li><li><a href=/posts/tech/under-the-ais-hood/ai_hood/ title="How does AI work ?">How does AI work ?</a></li><li><a class=active href=/posts/tech/nodejs-is-broken/nodejs_is_broken/ title="NodeJS is broken">NodeJS is broken</a></li><li><a href=/posts/tech/the-future-of-ai/the_future_of_ai/ title="The future of AI">The future of AI</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/tutorials/>Tutorials</a><ul><li><a href=/posts/tutorials/gathering-all-service-accounts-in-aws/gathering_svc_python/ title="Gathering service accounts">Gathering service accounts</a></li><li><a href=/posts/tutorials/introduction-to-kubernetes/get_started_with_k8s/ title="Intro to K8S">Intro to K8S</a></li><li><a href=/posts/tutorials/how-to-manage-your-infrastructure-using-terraform/terraform_infra/ title="Manage your infra with Terraform">Manage your infra with Terraform</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://olivierlespagnon.com/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/olivier_hu0e6c1c8c6dc6b67478684e7b00b46b4a_53705_120x120_fit_q75_box.jpeg alt="Author Image"><h5 class=author-name>Olivier Lespagnon</h5><p>February 13, 2023</p></div><div class=title><h1>NodeJS is broken</h1></div><div class=post-content id=post-content><p>I&rsquo;m not here to only critisize NodeJS. In fact it is the framework we use at my work, and in a LOT of companies.
It has served us well over the years in the browser, and after that, it has continued to help us on the server. Given the widespread knowledge of javascript, it&rsquo;s understandable that many people also reach for it when implementing their backends.</p><h2 id=cpu>CPU</h2><p>JavaScript&rsquo;s main disadvantage on the server is its single-threaded nature, which makes it difficult to fully utilize all the cores available. Developers must manually distribute the work to enable more cores, which is challenging and can result in inefficiencies compared to other platforms. The most common approach is to create multiple application instances, one per core, to take advantage of available processing power. However, developers using Rust, Go, or .NET do not have to worry about this issue, as their selected async runtime will handle this for them.</p><h2 id=memory>Memory</h2><p>Another flaw that might hit you if you are not aware of it is that V8 (the javascript runtime that powers node) is limited to a heap size of 2Gb/4Gb (differs between versions). It doesn&rsquo;t matter how much ram you have in your machine, if you reach this heap size usage, your application will crash, which could be devastating if the crash is due to high usage and not a memory leak. The way to counter this is to set the max-old-space-size setting on your node process to a limit that you deem correct for your server.</p><p>Developers working in Rust, Go or .net don&rsquo;t have to worry about this, as there is no hidden application crashing memory limit.</p><h2 id=performance>Performance</h2><p>Thanks to the competition over the years to get the fastest browser, we have gotten to a point where the performance of javascript can be pretty incredible. With that said, it&rsquo;s not guaranteed to be running at its peak performance. You see, javascript has two problems, first, it needs to have a fast “start from source”-time, then it needs to be able to run the actual application logic fast. This is solved by having a multi-step compilation process, where the first pass just gets the code up and running without spending much time on optimizations. After the application has been running for a while, V8 knows where its worth spending time applying optimizations and it will put its optimizing compiler on the task to do the optimizations.</p><p>Usually, this is fine, after a while when your node process has started up, it gets optimized and servers have historically been long-running processes. In the current days of serverless though, things are different. Sometimes code starts up to only do one pass through the code, this is not optimal for the V8 engine as it will never get a chance to apply its optimizations. With that said, it would be even worse if it did do its optimizations, as that would mean it spent lots of CPU cycles to optimize something that will be thrown away only milliseconds later.</p><p>A Rust developer doesn&rsquo;t have to worry about this, as the optimization happens at compile time, and when the application starts it runs at peak performance from the getgo.</p><h2 id=what-should-we-do-then->What should we do then ?</h2><p>Shifting away from Node.js to Rust for server-side code can bring benefits such as improved performance, memory safety, and better concurrency handling. However, making the transition requires careful consideration of the project&rsquo;s requirements, available resources, and the developer team&rsquo;s experience. A gradual migration approach may be more feasible, starting with small components and gradually moving to more complex features. Alternatively, some components can be written in Rust as a separate service and integrated with the existing Node.js application. Adequate training and documentation should also be provided to ensure a smooth transition for the development team. Ultimately, the decision to switch should be based on the project&rsquo;s needs, available resources, and long-term goals.</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/Olesp/olesp.github.io/edit/source/content/posts/Tech/NodeJS%20is%20broken/nodejs_is_broken.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/tech/under-the-ais-hood/ai_hood/ title="How does AI work ?" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i>Prev</div><div class=next-prev-text>How does AI work ?</div></a></div><div class="col-md-6 next-article"><a href=/posts/tech/the-future-of-ai/the_future_of_ai/ title="The future of AI" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>The future of AI</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#cpu>CPU</a></li><li><a href=#memory>Memory</a></li><li><a href=#performance>Performance</a></li><li><a href=#what-should-we-do-then->What should we do then ?</a></li></ul></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://olivierlespagnon.com/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://olivierlespagnon.com/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://olivierlespagnon.com/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://olivierlespagnon.com/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://olivierlespagnon.com/#projects>Achievements</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><span>Email:</span> <span>olespagnon@protonmail.com</span></li><li><span>Github:</span> <span>Olesp</span></li><li><span>Linkedin:</span> <span>olivierlespagnon</span></li></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2021 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>